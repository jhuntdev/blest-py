{"ast":null,"code":"var _jsxFileName = \"/Users/admin/srv/flex-js/examples/client/react/src/flex-react.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$();\nimport { useState, useRef, createContext, useContext, useCallback } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FlexContext = /*#__PURE__*/createContext();\nexport const FlexProvider = _ref => {\n  _s();\n  let {\n    children,\n    options\n  } = _ref;\n  const [queue, setQueue] = useState([]);\n  const [state, setState] = useState({});\n  const timeout = useRef();\n  const enqueue = useCallback((id, name, variables, options) => {\n    if (timeout.current) clearTimeout(timeout.current);\n    setState(state => {\n      return {\n        ...state,\n        [id]: {\n          loading: false,\n          error: null,\n          data: null\n        }\n      };\n    });\n    setQueue(queue => [...queue, [id, name, variables, options]]);\n  }, [setQueue, setState]);\n  useEffect(() => {\n    if (queue.length > 0) {\n      const myQueue = queue.map(q => [...q]);\n      setQueue([]);\n      timeout.current = setTimeout(() => {\n        setState(state => {\n          const newState = {\n            ...state\n          };\n          for (let i = 0; i < myQueue.length; i++) {\n            const item = myQueue[i];\n            newState[item[0]] = {\n              loading: true,\n              error: null,\n              data: null\n            };\n          }\n          return newState;\n        });\n        fetch({\n          ...options,\n          body: myQueue\n        }).then(async result => {\n          const results = await result.json();\n          setState(state => {\n            const newState = {\n              ...state\n            };\n            for (let i = 0; i < results.length; i++) {\n              const item = result[i];\n              newState[item[0]] = {\n                loading: false,\n                error: result[3],\n                data: result[2]\n              };\n            }\n            return newState;\n          });\n        }).catch(error => {\n          setState(state => {\n            const newState = {\n              ...state\n            };\n            for (let i = 0; i < myQueue.length; i++) {\n              const item = myQueue[i];\n              newState[item[0]] = {\n                loading: false,\n                error: error,\n                data: null\n              };\n            }\n            return newState;\n          });\n        });\n      }, 1);\n    }\n  }, [queue]);\n  return /*#__PURE__*/_jsxDEV(FlexContext.Provider, {\n    value: {\n      queue,\n      state,\n      enqueue\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n};\n_s(FlexProvider, \"mBYkQWTTurMinYl6WMCQZQsZys8=\");\n_c = FlexProvider;\nexport const useFlexContext = () => {\n  _s2();\n  const context = useContext(FlexContext);\n  console.warn('useFlexContext() is a utility function for debugging');\n  return context;\n};\n_s2(useFlexContext, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const useFlexQuery = (name, variables, options) => {\n  _s3();\n  const {\n    state,\n    enqueue\n  } = useContext(FlexContext);\n  const [requestId, setRequestId] = useState(null);\n  const queryState = requestId && state[requestId];\n  useEffect(() => {\n    const id = Math.round(Math.random() * 1000000).toString();\n    enqueue([id, name, variables, options]);\n    setRequestId(id);\n  }, [name, variables, options]);\n  return queryState || {};\n};\n_s3(useFlexQuery, \"maiCF1xyHMfvO+XJV1T/goLVUrU=\");\nexport const useFlexCommand = (name, options) => {\n  _s4();\n  const {\n    state,\n    enqueue\n  } = useContext(FlexContext);\n  const [requestId, setRequestId] = useState(null);\n  const queryState = requestId && state[requestId];\n  const request = useCallback(variables => {\n    const id = Math.round(Math.random() * 1000000).toString();\n    enqueue([id, name, variables, options]);\n    setRequestId(id);\n  }, [name, options, enqueue, setRequestId]);\n  return [request, queryState || {}];\n};\n_s4(useFlexCommand, \"yXByavvjwL9+LEBdvQ1zFKv6ZGs=\");\nvar _c;\n$RefreshReg$(_c, \"FlexProvider\");","map":{"version":3,"names":["useState","useRef","createContext","useContext","useCallback","jsxDEV","_jsxDEV","FlexContext","FlexProvider","_ref","_s","children","options","queue","setQueue","state","setState","timeout","enqueue","id","name","variables","current","clearTimeout","loading","error","data","useEffect","length","myQueue","map","q","setTimeout","newState","i","item","fetch","body","then","result","results","json","catch","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useFlexContext","_s2","context","console","warn","useFlexQuery","_s3","requestId","setRequestId","queryState","Math","round","random","toString","useFlexCommand","_s4","request","$RefreshReg$"],"sources":["/Users/admin/srv/flex-js/examples/client/react/src/flex-react.js"],"sourcesContent":["import { useState, useRef, createContext, useContext, useCallback } from 'react'\n\nconst FlexContext = createContext()\n\nexport const FlexProvider = ({ children, options }) => {\n\n  const [queue, setQueue] = useState([])\n  const [state, setState] = useState({})\n\n  const timeout = useRef()\n\n  const enqueue = useCallback((id, name, variables, options) => {\n    if (timeout.current) clearTimeout(timeout.current)\n    setState((state) => {\n      return {\n        ...state,\n        [id]: {\n          loading: false,\n          error: null,\n          data: null\n        }\n      }\n    })\n    setQueue((queue) => [...queue, [id, name, variables, options]])\n  }, [setQueue, setState])\n  \n  useEffect(() => {\n    if (queue.length > 0) {\n      const myQueue = queue.map((q) => [...q])\n      setQueue([])\n      timeout.current = setTimeout(() => {\n        setState((state) => {\n          const newState = {\n            ...state\n          }\n          for (let i = 0; i < myQueue.length; i++) {\n            const item = myQueue[i]\n            newState[item[0]] = {\n              loading: true,\n              error: null,\n              data: null\n            }\n          }\n          return newState\n        })\n        fetch({\n          ...options,\n          body: myQueue\n        })\n        .then(async (result) => {\n          const results = await result.json()\n          setState((state) => {\n            const newState = {\n              ...state\n            }\n            for (let i = 0; i < results.length; i++) {\n              const item = result[i]\n              newState[item[0]] = {\n                loading: false,\n                error: result[3],\n                data: result[2]\n              }\n            }\n            return newState\n          })\n        })\n        .catch((error) => {\n          setState((state) => {\n            const newState = {\n              ...state\n            }\n            for (let i = 0; i < myQueue.length; i++) {\n              const item = myQueue[i]\n              newState[item[0]] = {\n                loading: false,\n                error: error,\n                data: null\n              }\n            }\n            return newState\n          })\n        })\n      }, 1)\n    }\n  }, [queue])\n\n  return (\n    <FlexContext.Provider value={{ queue, state, enqueue }}>\n      {children}\n    </FlexContext.Provider>\n  )\n\n}\n\nexport const useFlexContext = () => {\n\n  const context = useContext(FlexContext)\n\n  console.warn('useFlexContext() is a utility function for debugging')\n\n  return context\n\n}\n\nexport const useFlexQuery = (name, variables, options) => {\n\n  const { state, enqueue } = useContext(FlexContext)\n  const [requestId, setRequestId] = useState(null)\n  const queryState = requestId && state[requestId]\n\n  useEffect(() => {\n    const id = Math.round(Math.random() * 1000000).toString()\n    enqueue([id, name, variables, options])\n    setRequestId(id)\n  }, [name, variables, options])\n\n  return queryState || {}\n\n}\n\nexport const useFlexCommand = (name, options) => {\n  \n  const { state, enqueue } = useContext(FlexContext)\n  const [requestId, setRequestId] = useState(null)\n  const queryState = requestId && state[requestId]\n\n  const request = useCallback((variables) => {\n    const id = Math.round(Math.random() * 1000000).toString()\n    enqueue([id, name, variables, options])\n    setRequestId(id)\n  }, [name, options, enqueue, setRequestId])\n\n  return [request, queryState || {}]\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}